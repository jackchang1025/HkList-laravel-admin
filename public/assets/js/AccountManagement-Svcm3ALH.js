/* empty css             *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css                  *//* empty css                  *//* empty css                        *//* empty css                        *//* empty css                  *//* empty css                  */import{i as A}from"./index-PNpWQo2V.js";/* empty css                   *//* empty css                     */import"./AdminView-B3WA7Z1j.js";import{g as W}from"./enterprise-DJ140WNJ.js";import{E as v,g as ce,c as pe,i as X,j as Y,b as Z,e as re,d as ee,k as me,v as te,m as _e,q as fe,r as ye,o as ve,u as ke}from"./element-plus-vendor-C_pH9kLN.js";import{k as ae,av as be,aw as ge,a as V,d as le,l as o,J as f,K as a,S as l,Q as p,L as ne,m as k,F as S,a7 as L,R as _,P as i,p as K,u as O}from"./vue-vendor-BPxk_gY3.js";import{f as Q}from"./format-CyW-QbYa.js";import{_ as Ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./other-vendor-DRuaNSIU.js";/* empty css                */const Ae=r=>A.post("/admin/account",r),xe=r=>A.get(`/admin/account?page=${r.page}&size=${r.size}`),$e=r=>A.patch(`/admin/account/${r.id}`,r),Ce=r=>A.patch("/admin/account/info",{account_ids:[r.id]}),Ue=r=>A.patch("/admin/account/info",{account_ids:r}),ze=r=>A.delete("/admin/account",{data:{account_ids:[r.id]}}),Se=r=>A.delete("/admin/account",{data:{account_ids:r}}),H=r=>A.patch("/admin/account/switch",r),Ee=r=>A.get(`/admin/account/ban?account_id=${r.id}`),he=()=>A.patch("/admin/account/ban"),we=ae({__name:"AddAccount",props:{modelValue:{},modelModifiers:{}},emits:be(["getAccounts"],["update:modelValue"]),setup(r,{emit:c}){const U=c,C=ge(r,"modelValue"),x=V(!1),m=V({type:1,cookie:"",enterprise_account_id:null}),b=V(null),F={cookie:[{required:!0,message:"请输入账户信息",trigger:"blur"}],enterprise_account_id:[{required:!1,message:"请选择关联的企业账号",trigger:"change"}]},I=V([]),M=async()=>{try{const g=await W({page:1,size:100,is_active:!0});I.value=g.data.list}catch(g){console.error("获取企业账号列表失败:",g)}};le(()=>{M()});const N=async g=>{if(!(!g||!await g.validate()))try{x.value=!0,(await Ae(m.value)).data.have_repeat&&v.info("存在重复的账号,已自动过滤"),v.success("添加成功")}finally{x.value=!1}},T=g=>{U("getAccounts"),g()},P=()=>{C.value=!1,U("getAccounts")};return(g,d)=>{const R=ce,$=pe,z=X,D=Y,E=Z,q=re,u=ee,t=me,y=te;return o(),f(t,{title:"添加账号",width:"60%",modelValue:C.value,"onUpdate:modelValue":d[6]||(d[6]=s=>C.value=s),"before-close":T},{footer:a(()=>[l(u,{type:"info",onClick:d[4]||(d[4]=s=>P())},{default:a(()=>d[8]||(d[8]=[p("取消")])),_:1}),l(u,{type:"primary",onClick:d[5]||(d[5]=s=>N(b.value))},{default:a(()=>d[9]||(d[9]=[p("添加")])),_:1})]),default:a(()=>[ne((o(),f(q,{ref_key:"addAccountFormRef",ref:b,model:m.value,rules:F,"label-width":"auto"},{default:a(()=>[l($,{label:"提示"},{default:a(()=>[l(R,null,{default:a(()=>d[7]||(d[7]=[p("可以使用换行来分割多个账号")])),_:1})]),_:1}),l($,{label:"账号类型"},{default:a(()=>[l(D,{modelValue:m.value.type,"onUpdate:modelValue":d[0]||(d[0]=s=>m.value.type=s)},{default:a(()=>[l(z,{label:"cookie",value:1}),l(z,{label:"token",value:2}),l(z,{label:"enterprise",value:3})]),_:1},8,["modelValue"])]),_:1}),m.value.type===1||m.value.type===3?(o(),f($,{key:0,label:"Cookie",prop:"cookie"},{default:a(()=>[l(E,{type:"textarea",modelValue:m.value.cookie,"onUpdate:modelValue":d[1]||(d[1]=s=>m.value.cookie=s)},null,8,["modelValue"])]),_:1})):(o(),f($,{key:1,label:"refresh_token",prop:"cookie"},{default:a(()=>[l(E,{type:"textarea",modelValue:m.value.cookie,"onUpdate:modelValue":d[2]||(d[2]=s=>m.value.cookie=s)},null,8,["modelValue"])]),_:1})),l($,{label:"关联企业账号",prop:"enterprise_account_id"},{default:a(()=>[l(D,{modelValue:m.value.enterprise_account_id,"onUpdate:modelValue":d[3]||(d[3]=s=>m.value.enterprise_account_id=s),clearable:"",placeholder:"选择企业账号"},{default:a(()=>[(o(!0),k(S,null,L(I.value,s=>(o(),f(z,{key:s.id,label:s.cid,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[y,x.value]])]),_:1},8,["modelValue"])}}}),Le={key:0},Ie={key:0},De={key:0},Be={key:0},Fe={key:0},Me={key:0},Ne={key:0},Te={key:0},Pe={key:0},Re={key:0},qe={key:0},je=ae({__name:"AccountManagement",setup(r){const c=V(!1),U=V(15),C=V(1),x=V(),m=V([]),b=async()=>{try{c.value=!0;const u=await xe({page:C.value,size:U.value});u.data.data=u.data.data.map(t=>(t.switch=!!t.switch,t)),x.value=u.data}finally{c.value=!1}},F=async u=>{try{c.value=!0,await Ce(u),v.success("更新账户信息成功")}finally{c.value=!1,await b()}},I=async()=>{try{c.value=!0;const u=m.value.map(t=>t.id);await Ue(u),v.success("批量更新账户成功")}finally{c.value=!1,await b()}},M=async u=>{try{c.value=!0,await ze(u),v.success("删除账户成功")}finally{c.value=!1,await b()}},N=async()=>{try{c.value=!0;const u=m.value.map(t=>t.id);await Se(u),v.success("批量删除账户成功")}finally{c.value=!1,await b()}},T=async()=>{try{c.value=!0;const u=m.value.map(t=>t.id);await H({account_ids:u,switch:1}),v.success("批量启用账户成功")}finally{c.value=!1,await b()}},P=async()=>{try{c.value=!0;const u=m.value.map(t=>t.id);await H({account_ids:u,switch:0}),v.success("批量禁用账户成功")}finally{c.value=!1,await b()}},g=u=>m.value=u;le(async()=>{await b(),await q()});const d=V(!1),R=()=>d.value=!d.value,$=async u=>{if(u.edit=!u.edit,u.edit===!1)try{c.value=!0,await $e(u),v.success("修改賬號成功")}finally{c.value=!1,await b()}},z=async()=>{try{c.value=!0,await he(),v.success("启用被限速账号成功")}finally{c.value=!1,await b()}},D=async u=>{try{c.value=!0;const t=await Ee(u);if(t.data.errno===0){const y=t.data.anti;v.success("获取封禁信息成功"),y.ban_status?(v.success("封禁状态：已封禁"),v.success(`封禁开始时间: ${new Date(parseInt(`${y.start_time}000`)).toLocaleString()}`),v.success(`封禁结束时间: ${new Date(parseInt(`${y.end_time}000`)).toLocaleString()}`),v.success(`已被封禁${y.ban_times}次`),v.success(`封禁原因: ${y.ban_reason}`)):v.success("封禁状态：未封禁")}else t.data.errno===-6?v.warning("获取封禁信息失败,Cookie或AccessToken已过期"):v.warning(`获取封禁信息失败,code:${t.data.errno},msg:${t.data.errmsg}`)}finally{c.value=!1}},E=V([]),q=async()=>{try{const u=await W({page:1,size:100,is_active:!0});E.value=u.data.list}catch(u){console.error("获取企业账号列表失败:",u)}};return(u,t)=>{var j,G,J;const y=ee,s=_e,h=Z,w=X,B=Y,oe=fe,se=ye,ue=ve,de=ke,ie=te;return o(),k(S,null,[l(we,{onGetAccounts:b,modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e)},null,8,["modelValue"]),l(y,{type:"primary",onClick:t[1]||(t[1]=e=>b())},{default:a(()=>t[10]||(t[10]=[p("刷新列表")])),_:1}),l(y,{type:"primary",onClick:t[2]||(t[2]=e=>R())},{default:a(()=>t[11]||(t[11]=[p("添加账号")])),_:1}),l(y,{type:"primary",disabled:m.value.length<=0,onClick:t[3]||(t[3]=e=>I())},{default:a(()=>t[12]||(t[12]=[p(" 批量更新信息 ")])),_:1},8,["disabled"]),l(y,{type:"primary",disabled:m.value.length<=0,onClick:t[4]||(t[4]=e=>T())},{default:a(()=>t[13]||(t[13]=[p(" 批量启用 ")])),_:1},8,["disabled"]),l(y,{type:"primary",disabled:m.value.length<=0,onClick:t[5]||(t[5]=e=>P())},{default:a(()=>t[14]||(t[14]=[p(" 批量禁用 ")])),_:1},8,["disabled"]),l(y,{type:"danger",disabled:m.value.length<=0,onClick:t[6]||(t[6]=e=>N())},{default:a(()=>t[15]||(t[15]=[p(" 批量删除 ")])),_:1},8,["disabled"]),l(y,{type:"primary",onClick:t[7]||(t[7]=e=>z())},{default:a(()=>t[16]||(t[16]=[p(" 启用被限速的账号 ")])),_:1}),ne((o(),f(ue,{data:((j=x.value)==null?void 0:j.data)??[],border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:g},{default:a(()=>[l(s,{type:"selection",fixed:"",width:"40"}),l(s,{prop:"id",label:"ID",fixed:""}),l(s,{prop:"baidu_name",label:"百度用户名",width:"150px"},{default:a(({row:e})=>[e.edit?i("",!0):(o(),k("span",Le,_(e.baidu_name),1)),e.edit?(o(),f(h,{key:1,modelValue:e.baidu_name,"onUpdate:modelValue":n=>e.baidu_name=n},null,8,["modelValue","onUpdate:modelValue"])):i("",!0)]),_:1}),l(s,{prop:"today_size",label:"今日解析",width:"150px"},{default:a(({row:e})=>[K("span",null,_(e.today_count)+" ("+_(O(Q)(e.today_size??0))+")",1)]),_:1}),l(s,{prop:"today_size",label:"总共解析",width:"150px"},{default:a(({row:e})=>[K("span",null,_(e.total_count)+" ("+_(O(Q)(e.total_size??0))+")",1)]),_:1}),l(s,{prop:"account_type",label:"账号类型",width:"160px"},{default:a(({row:e})=>[e.edit?i("",!0):(o(),k("span",Ie,_(e.account_type),1)),e.edit?(o(),f(B,{key:1,modelValue:e.account_type,"onUpdate:modelValue":n=>e.account_type=n},{default:a(()=>[(o(),k(S,null,L(["cookie","access_token"],n=>l(w,{key:n,value:n},{default:a(()=>[p(_(n),1)]),_:2},1032,["value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])):i("",!0)]),_:1}),l(s,{prop:"cookie",label:"Cookie",width:"150px"},{default:a(({row:e})=>[e.edit?i("",!0):(o(),k("span",De,_(e.cookie),1)),e.edit?(o(),f(h,{key:1,modelValue:e.cookie,"onUpdate:modelValue":n=>e.cookie=n},null,8,["modelValue","onUpdate:modelValue"])):i("",!0)]),_:1}),l(s,{prop:"enterprise_account",label:"关联企业账号",width:"200px"},{default:a(({row:e})=>[e.edit?i("",!0):(o(),k("span",Be,_(e.enterprise_account?`${e.enterprise_account.cid}`:"未关联"),1)),e.edit?(o(),f(B,{key:1,modelValue:e.enterprise_account_id,"onUpdate:modelValue":n=>e.enterprise_account_id=n,clearable:"",placeholder:"选择企业账号"},{default:a(()=>[(o(!0),k(S,null,L(E.value,n=>(o(),f(w,{key:n.id,label:n.cid,value:n.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):i("",!0)]),_:1}),l(s,{prop:"expired_at",label:"token过期时间",width:"160px"},{default:a(({row:e})=>[p(_(e.expired_at?new Date(e.expired_at).toLocaleString():"非token模式"),1)]),_:1}),l(s,{prop:"vip_type",label:"会员类型",width:"130px"},{default:a(({row:e})=>[e.edit?i("",!0):(o(),k("span",Fe,_(e.vip_type),1)),e.edit?(o(),f(B,{key:1,modelValue:e.vip_type,"onUpdate:modelValue":n=>e.vip_type=n},{default:a(()=>[(o(),k(S,null,L(["超级会员","假超级会员","普通会员","普通用户"],n=>l(w,{key:n,value:n},{default:a(()=>[p(_(n),1)]),_:2},1032,["value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])):i("",!0)]),_:1}),l(s,{prop:"switch",label:"状态",width:"70px"},{default:a(({row:e})=>[e.edit?i("",!0):(o(),k("span",Me,_(e.switch?"启用":"禁用"),1)),e.edit?(o(),f(oe,{key:1,modelValue:e.switch,"onUpdate:modelValue":n=>e.switch=n},null,8,["modelValue","onUpdate:modelValue"])):i("",!0)]),_:1}),l(s,{prop:"prov",label:"省份",width:"120px"},{default:a(({row:e})=>[e.edit?i("",!0):(o(),k("span",Ne,_(e.prov??"未使用"),1)),e.edit?(o(),f(B,{key:1,modelValue:e.prov,"onUpdate:modelValue":n=>e.prov=n},{default:a(()=>[(o(),f(w,{key:null,value:null},{default:a(()=>t[17]||(t[17]=[p("未使用")])),_:1})),(o(),k(S,null,L(["北京市","天津市","上海市","重庆市","河北省","山西省","内蒙古自治区","辽宁省","吉林省","黑龙江省","江苏省","浙江省","安徽省","福建省","江西省","山东省","河南省","湖北省","湖南省","广东省","广西壮族自治区","海南省","四川省","贵州省","云南省","西藏自治区","陕西省","甘肃省","青海省","宁夏回族自治区","新疆维吾尔自治区","香港特别行政区","澳门特别行政区","台湾省"],n=>l(w,{key:n,label:n,value:n},null,8,["label","value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])):i("",!0)]),_:1}),l(s,{prop:"reason",label:"禁用原因",width:"150px"},{default:a(({row:e})=>[e.edit?i("",!0):(o(),k("span",Te,_(e.reason??"未禁用"),1)),e.edit?(o(),f(h,{key:1,modelValue:e.reason,"onUpdate:modelValue":n=>e.reason=n},null,8,["modelValue","onUpdate:modelValue"])):i("",!0)]),_:1}),l(s,{prop:"access_token",label:"access_token",width:"150px"},{default:a(({row:e})=>[e.edit?i("",!0):(o(),k("span",Pe,_(e.access_token),1)),e.edit?(o(),f(h,{key:1,modelValue:e.access_token,"onUpdate:modelValue":n=>e.access_token=n},null,8,["modelValue","onUpdate:modelValue"])):i("",!0)]),_:1}),l(s,{prop:"refresh_token",label:"refresh_token",width:"150px"},{default:a(({row:e})=>[e.edit?i("",!0):(o(),k("span",Re,_(e.refresh_token),1)),e.edit?(o(),f(h,{key:1,modelValue:e.refresh_token,"onUpdate:modelValue":n=>e.refresh_token=n},null,8,["modelValue","onUpdate:modelValue"])):i("",!0)]),_:1}),l(s,{prop:"cid",label:"cid",width:"200px"},{default:a(({row:e})=>[e.edit?i("",!0):(o(),k("span",qe,_(e.cid),1)),e.edit?(o(),f(se,{key:1,modelValue:e.cid,"onUpdate:modelValue":n=>e.cid=n,style:{width:"170px"}},null,8,["modelValue","onUpdate:modelValue"])):i("",!0)]),_:1}),l(s,{prop:"svip_end_at",label:"超级会员结束时间",width:"160px"},{default:a(({row:e})=>[p(_(new Date(e.svip_end_at).toLocaleString()),1)]),_:1}),l(s,{prop:"last_use_at",label:"上次使用时间",width:"160px"},{default:a(({row:e})=>[p(_(new Date(e.last_use_at).toLocaleString()),1)]),_:1}),l(s,{prop:"created_at",label:"创建时间",width:"160px"},{default:a(({row:e})=>[p(_(new Date(e.created_at).toLocaleString()),1)]),_:1}),l(s,{prop:"updated_at",label:"更新时间",width:"160px"},{default:a(({row:e})=>[p(_(new Date(e.updated_at).toLocaleString()),1)]),_:1}),l(s,{width:"350",label:"操作",fixed:"right"},{default:a(({row:e})=>[l(y,{size:"small",type:"primary",disabled:e.id===0,onClick:n=>F(e)},{default:a(()=>t[18]||(t[18]=[p("更新信息")])),_:2},1032,["disabled","onClick"]),l(y,{size:"small",type:"primary",disabled:e.id===0,onClick:n=>D(e)},{default:a(()=>t[19]||(t[19]=[p(" 检查封禁状态 ")])),_:2},1032,["disabled","onClick"]),e.edit?i("",!0):(o(),f(y,{key:0,size:"small",type:"primary",disabled:e.id===0,onClick:n=>$(e)},{default:a(()=>t[20]||(t[20]=[p(" 編輯 ")])),_:2},1032,["disabled","onClick"])),e.edit?(o(),f(y,{key:1,size:"small",type:"primary",disabled:e.id===0,onClick:n=>$(e)},{default:a(()=>t[21]||(t[21]=[p(" 完成 ")])),_:2},1032,["disabled","onClick"])):i("",!0),l(y,{size:"small",type:"danger",disabled:e.id===0,onClick:n=>M(e)},{default:a(()=>t[22]||(t[22]=[p("删除")])),_:2},1032,["disabled","onClick"])]),_:1})]),_:1},8,["data"])),[[ie,c.value]]),l(de,{"current-page":C.value,"onUpdate:currentPage":t[8]||(t[8]=e=>C.value=e),"page-size":U.value,"onUpdate:pageSize":t[9]||(t[9]=e=>U.value=e),"page-sizes":[15,50,100,500,((G=x.value)==null?void 0:G.total)??100],total:((J=x.value)==null?void 0:J.total)??100,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:b,onCurrentChange:b},null,8,["current-page","page-size","page-sizes","total"])],64)}}}),pt=Ve(je,[["__scopeId","data-v-ca3ebfb6"]]);export{pt as default};
