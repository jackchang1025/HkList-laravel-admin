import{E as g,b as T,c as R,q as Y,e as N,d as P,k as Z,v as j,s as L,i as ee,j as le,m as ae,t as te,o as oe,u as ne}from"./element-plus@2.7.7_vue@3.4.32_typescript@5.5.3_-BPm-_N_9.js";import{c as se}from"./@vue_runtime-dom@3.4.32-DNdjNMzo.js";import{u as re,c as ie,g as ue,d as de,a as pe,t as me}from"./enterprise-CLm0S6bc.js";import{d as G,w as ce,o as x,G as B,H as l,i as e,L as c,I as K,m as ve,c as _e,a as M,F as fe}from"./@vue_runtime-core@3.4.32-BofAHbgu.js";import{r as u}from"./@vue_reactivity@3.4.32-DksAu7zd.js";import{L as $}from"./@vue_shared@3.4.32-CaCWPAm8.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./lodash-es@4.17.21-BB-zMWwC.js";import"./async-validator@4.2.5-DKvM95Vc.js";import"./@vueuse_core@9.13.0_vue@3.4.32_typescript@5.5.3_-DkVRVfGD.js";import"./@vueuse_shared@9.13.0_vue@3.4.32_typescript@5.5.3_-BbpdFR9m.js";import"./dayjs@1.11.11-Ct2Knyoi.js";import"./@element-plus_icons-vue@2.3.1_vue@3.4.32_typescript@5.5.3_-x2o2c_8n.js";import"./@sxzz_popperjs-es@2.11.7-D9SI2xQl.js";import"./normalize-wheel-es@1.2.0-B6fDCfyv.js";import"./@ctrl_tinycolor@3.6.1-r5W6hzzQ.js";import"./index-5gje5YFo.js";import"./pinia@2.1.7_typescript@5.5.3_vue@3.4.32_typescript@5.5.3_-BSzeUtha.js";import"./vue-demi@0.14.8_vue@3.4.32_typescript@5.5.3_-Dq6ymT-8.js";import"./axios@1.7.2-B4uVmeYG.js";import"./vue-router@4.4.0_vue@3.4.32_typescript@5.5.3_-ByijA4Eg.js";const be=G({__name:"AddEnterprise",props:{modelValue:{type:Boolean}},emits:["update:modelValue","getEnterprises"],setup(q,{expose:p,emit:k}){const E=q,y=k,w=u(),b=u(!1),d=u(null),a=u({cid:"",name:"",cookie:"",bdstoken:"",surl:"",pwd:"",path:"",is_active:!0}),C={cid:[{required:!0,message:"请输入企业CID",trigger:"blur"}],name:[{required:!0,message:"请输入企业名称",trigger:"blur"}],cookie:[{required:!0,message:"请输入Cookie",trigger:"blur"}],bdstoken:[{required:!0,message:"请输入安全令牌",trigger:"blur"}],surl:[{required:!0,message:"请输入分享链接",trigger:"blur"}],path:[{required:!0,message:"请输入存储路径",trigger:"blur"}]};ce(()=>E.modelValue,r=>{r||h()});const m=r=>{d.value=r,a.value={cid:r.cid,name:r.name,cookie:r.cookie,bdstoken:r.bdstoken,surl:r.surl,pwd:r.pwd||"",path:r.path,is_active:r.is_active}},h=()=>{w.value&&w.value.resetFields(),d.value=null,a.value={cid:"",name:"",cookie:"",bdstoken:"",surl:"",pwd:"",path:"",is_active:!0}},U=()=>{y("update:modelValue",!1),h()},z=async r=>{if(r)try{await r.validate(),b.value=!0,d.value?(await re(d.value.id,a.value),g.success("更新成功")):(await ie(a.value),g.success("添加成功")),y("getEnterprises"),y("update:modelValue",!1)}catch(t){t!=="cancel"&&g.error(d.value?"更新失败":"添加失败")}finally{b.value=!1}};return p({setEditingEnterprise:m}),(r,t)=>{const _=T,v=R,D=Y,S=N,i=P,o=Z,I=j;return x(),B(o,{title:d.value?"编辑企业账号":"添加企业账号",width:"60%","model-value":r.modelValue,"onUpdate:modelValue":t[9]||(t[9]=n=>y("update:modelValue",n)),"before-close":U},{footer:l(()=>[e(i,{onClick:U},{default:l(()=>[c("取消")]),_:1}),e(i,{type:"primary",onClick:t[8]||(t[8]=n=>z(w.value))},{default:l(()=>[c("确定")]),_:1})]),default:l(()=>[K((x(),B(S,{ref_key:"formRef",ref:w,model:a.value,rules:C,"label-width":"120px"},{default:l(()=>[e(v,{label:"企业CID",prop:"cid"},{default:l(()=>[e(_,{modelValue:a.value.cid,"onUpdate:modelValue":t[0]||(t[0]=n=>a.value.cid=n),placeholder:"请输入企业CID"},null,8,["modelValue"])]),_:1}),e(v,{label:"企业名称",prop:"name"},{default:l(()=>[e(_,{modelValue:a.value.name,"onUpdate:modelValue":t[1]||(t[1]=n=>a.value.name=n),placeholder:"请输入企业名称"},null,8,["modelValue"])]),_:1}),e(v,{label:"Cookie",prop:"cookie"},{default:l(()=>[e(_,{modelValue:a.value.cookie,"onUpdate:modelValue":t[2]||(t[2]=n=>a.value.cookie=n),type:"textarea",rows:3,placeholder:"请输入Cookie"},null,8,["modelValue"])]),_:1}),e(v,{label:"安全令牌",prop:"bdstoken"},{default:l(()=>[e(_,{modelValue:a.value.bdstoken,"onUpdate:modelValue":t[3]||(t[3]=n=>a.value.bdstoken=n),placeholder:"请输入bdstoken"},null,8,["modelValue"])]),_:1}),e(v,{label:"分享链接",prop:"surl"},{default:l(()=>[e(_,{modelValue:a.value.surl,"onUpdate:modelValue":t[4]||(t[4]=n=>a.value.surl=n),placeholder:"请输入分享链接"},null,8,["modelValue"])]),_:1}),e(v,{label:"提取密码",prop:"pwd"},{default:l(()=>[e(_,{modelValue:a.value.pwd,"onUpdate:modelValue":t[5]||(t[5]=n=>a.value.pwd=n),placeholder:"请输入提取密码(可选)"},null,8,["modelValue"])]),_:1}),e(v,{label:"存储路径",prop:"path"},{default:l(()=>[e(_,{modelValue:a.value.path,"onUpdate:modelValue":t[6]||(t[6]=n=>a.value.path=n),placeholder:"请输入存储路径"},null,8,["modelValue"])]),_:1}),e(v,{label:"状态",prop:"is_active"},{default:l(()=>[e(D,{modelValue:a.value.is_active,"onUpdate:modelValue":t[7]||(t[7]=n=>a.value.is_active=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[I,b.value]])]),_:1},8,["title","model-value"])}}}),ye={class:"toolbar"},we={class:"action-buttons"},Ve=G({__name:"EnterpriseManagement",setup(q){const p=u(!1),k=u(1),E=u(15),y=u(0),w=u([]),b=u([]),d=u(!1),a=u({keyword:"",is_active:void 0}),C=u(null),m=async()=>{try{p.value=!0;const i=await ue({page:k.value,size:E.value,...a.value});w.value=i.data.list,y.value=i.data.pagination.total}finally{p.value=!1}},h=()=>{k.value=1,m()},U=()=>m(),z=()=>m(),r=i=>{b.value=i},t=()=>{d.value=!d.value},_=async i=>{try{await L.confirm("确定要删除该企业账号吗？","提示",{type:"warning"}),p.value=!0,await de(i.id),g.success("删除成功"),m()}catch(o){o!=="cancel"&&g.error("删除失败")}finally{p.value=!1}},v=async()=>{try{await L.confirm(`确定要删除选中的 ${b.value.length} 个企业账号吗？`,"提示",{type:"warning"}),p.value=!0,await pe(b.value.map(i=>i.id)),g.success("批量删除成功"),m()}catch(i){i!=="cancel"&&g.error("批量删除失败")}finally{p.value=!1}},D=async i=>{try{p.value=!0;const o=await me(i.id);g.success(o.data.status),m()}catch{g.error("操作失败")}finally{p.value=!1}},S=i=>{var o;(o=C.value)==null||o.setEditingEnterprise(i),d.value=!0};return ve(m),(i,o)=>{const I=T,n=R,F=ee,H=le,V=P,O=N,f=ae,J=te,Q=oe,W=ne,X=j;return x(),_e(fe,null,[e(be,{onGetEnterprises:m,modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=s=>d.value=s),ref_key:"addEnterpriseRef",ref:C},null,8,["modelValue"]),M("div",ye,[e(O,{inline:!0,model:a.value},{default:l(()=>[e(n,{label:"关键词"},{default:l(()=>[e(I,{modelValue:a.value.keyword,"onUpdate:modelValue":o[1]||(o[1]=s=>a.value.keyword=s),placeholder:"搜索名称/CID/短链/路径",clearable:"",onKeyup:se(h,["enter"])},null,8,["modelValue"])]),_:1}),e(n,{label:"状态"},{default:l(()=>[e(H,{modelValue:a.value.is_active,"onUpdate:modelValue":o[2]||(o[2]=s=>a.value.is_active=s),clearable:"",placeholder:"全部",style:{width:"100px"}},{default:l(()=>[e(F,{label:"激活",value:!0}),e(F,{label:"停用",value:!1})]),_:1},8,["modelValue"])]),_:1}),e(n,null,{default:l(()=>[e(V,{type:"primary",onClick:h},{default:l(()=>[c("搜索")]),_:1})]),_:1})]),_:1},8,["model"]),M("div",we,[e(V,{type:"primary",onClick:o[3]||(o[3]=s=>m())},{default:l(()=>[c("刷新列表")]),_:1}),e(V,{type:"primary",onClick:o[4]||(o[4]=s=>t())},{default:l(()=>[c("添加账号")]),_:1}),e(V,{type:"danger",disabled:b.value.length<=0,onClick:v},{default:l(()=>[c(" 批量删除 ")]),_:1},8,["disabled"])])]),K((x(),B(Q,{data:w.value,border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:r},{default:l(()=>[e(f,{type:"selection",width:"40"}),e(f,{prop:"id",label:"ID",width:"80"}),e(f,{prop:"name",label:"企业名称","min-width":"120"}),e(f,{prop:"cid",label:"企业CID","min-width":"120"}),e(f,{prop:"surl",label:"分享链接","min-width":"120","show-overflow-tooltip":""}),e(f,{prop:"path",label:"存储路径","min-width":"120","show-overflow-tooltip":""}),e(f,{prop:"is_active",label:"状态",width:"100"},{default:l(({row:s})=>[e(J,{type:s.is_active?"success":"danger"},{default:l(()=>[c($(s.is_active?"已激活":"已停用"),1)]),_:2},1032,["type"])]),_:1}),e(f,{prop:"created_at",label:"创建时间",width:"180"},{default:l(({row:s})=>[c($(new Date(s.created_at).toLocaleString()),1)]),_:1}),e(f,{width:"250",label:"操作",fixed:"right"},{default:l(({row:s})=>[e(V,{size:"small",type:s.is_active?"warning":"success",onClick:A=>D(s)},{default:l(()=>[c($(s.is_active?"停用":"激活"),1)]),_:2},1032,["type","onClick"]),e(V,{size:"small",type:"primary",onClick:A=>S(s)},{default:l(()=>[c(" 编辑 ")]),_:2},1032,["onClick"]),e(V,{size:"small",type:"danger",onClick:A=>_(s)},{default:l(()=>[c(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[X,p.value]]),e(W,{"current-page":k.value,"onUpdate:currentPage":o[5]||(o[5]=s=>k.value=s),"page-size":E.value,"onUpdate:pageSize":o[6]||(o[6]=s=>E.value=s),"page-sizes":[15,50,100],total:y.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:U,onCurrentChange:z},null,8,["current-page","page-size","total"])],64)}}}),je=ge(Ve,[["__scopeId","data-v-a007b362"]]);export{je as default};
