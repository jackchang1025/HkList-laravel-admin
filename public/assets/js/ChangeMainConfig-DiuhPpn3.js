import{E as f,b as S,c as $,q as N,r as R,i as I,j as D,d as L,e as T,v as W}from"./element-plus@2.7.7_vue@3.4.32_typescript@5.5.3_-BPm-_N_9.js";import{i as x,n as j}from"./index-BcUQltO2.js";import{u as J}from"./changeConfigForm-Ba61w-Zy.js";import{s as H}from"./pinia@2.1.7_typescript@5.5.3_vue@3.4.32_typescript@5.5.3_-BSzeUtha.js";import{d as K,m as O,I as Y,o as g,G as w,H as i,c as y,F as U,i as a,K as v,L as C}from"./@vue_runtime-core@3.4.32-BofAHbgu.js";import{r as M,u as t}from"./@vue_reactivity@3.4.32-DksAu7zd.js";import"./@vue_runtime-dom@3.4.32-DNdjNMzo.js";import"./@vue_shared@3.4.32-CaCWPAm8.js";import"./lodash-es@4.17.21-BB-zMWwC.js";import"./async-validator@4.2.5-DKvM95Vc.js";import"./@vueuse_core@9.13.0_vue@3.4.32_typescript@5.5.3_-DkVRVfGD.js";import"./@vueuse_shared@9.13.0_vue@3.4.32_typescript@5.5.3_-BbpdFR9m.js";import"./dayjs@1.11.11-Ct2Knyoi.js";import"./@element-plus_icons-vue@2.3.1_vue@3.4.32_typescript@5.5.3_-x2o2c_8n.js";import"./@sxzz_popperjs-es@2.11.7-D9SI2xQl.js";import"./normalize-wheel-es@1.2.0-B6fDCfyv.js";import"./@ctrl_tinycolor@3.6.1-r5W6hzzQ.js";import"./axios@1.7.2-B4uVmeYG.js";import"./@fingerprintjs_fingerprintjs@4.5.1-5RNCfJbQ.js";import"./tslib@2.6.3-CPxunF3b.js";import"./vue-router@4.4.0_vue@3.4.32_typescript@5.5.3_-ByijA4Eg.js";import"./vue-demi@0.14.8_vue@3.4.32_typescript@5.5.3_-Dq6ymT-8.js";const Q=()=>x.get("/admin/config/main"),X=m=>x.patch("/admin/config/main",m),Z=m=>x.post("/admin/config/main/testAuth",m),ze=K({__name:"ChangeMainConfig",props:["Mode"],setup(m){const p=M(!1),q=J(),{changeConfigForm:e}=H(q),V=M(null),A={name:[{required:!0,message:"请输入站点名称",trigger:"blur"}],sleep:[{required:!0,message:"请输入批量解析时休眠时间",trigger:"blur"}],max_once:[{required:!0,message:"请输入批量解析时单次最大解析数量",trigger:"blur"}],max_filesize:[{required:!0,message:"请输入单日单个账号最大解析大小",trigger:"blur"}],min_single_filesize:[{required:!0,message:"请输入可解析文件最小需要大小",trigger:"blur"}],max_single_filesize:[{required:!0,message:"请输入可解析文件最大可是大小",trigger:"blur"}],user_agent:[{required:!0,message:"请输入User_Agent",trigger:"blur"}]},b=async()=>{try{p.value=!0;const l=(await Q()).data;e.value={...l,max_filesize:l.max_filesize/1024**3,min_single_filesize:l.min_single_filesize/1024**3,max_single_filesize:l.max_single_filesize/1024**3,front_end_version:await j(),announce:l.announce.replaceAll("[NextLine]",`
`)}}finally{p.value=!1}},B=async d=>{if(!(!d||!await d.validate())){if(e.value.parse_mode===11&&!/^netdisk;/.test(e.value.user_agent)){f.error("User_Agent格式不正确, 请使用 netdisk;xxx");return}try{p.value=!0,await X({...e.value,max_filesize:e.value.max_filesize*1024**3,min_single_filesize:e.value.min_single_filesize*1024**3,max_single_filesize:e.value.max_single_filesize*1024**3}),f.success("保存成功")}finally{p.value=!1,await b()}}},E=async d=>{if(!(!d||!await d.validate()))try{p.value=!0;const l=await Z({...e.value,max_filesize:e.value.max_filesize*1024**3,min_single_filesize:e.value.min_single_filesize*1024**3,max_single_filesize:e.value.max_single_filesize*1024**3});"ip"in l.data?f.error(`未知授权码,当前ip为: ${l.data.ip}`):f.success(`测试通过,有效期至: ${l.data.expired_at}`)}finally{p.value=!1,await b()}};O(b);const z=()=>{let d="";switch(e.value.parse_mode){case 5:d="pan.baidu.com";break;case 1:case 8:d="netdisk;P2SP;3.0.10.22";break;case 6:case 7:d="netdisk;P2SP;3.0.20.4;netdisk;4.36.2;PC;PC-Windows;10.0.19045;UniBaiduYunGuanJia";break;case 2:case 9:d="netdisk;12.11.9;23049RAD8C;android-android;13;JSbridge4.4.0;jointBridge;1.1.0;";break;case 10:d="Mozilla/5.0 (94list-laravel;netdisk;svip)";break;case 11:d="netdisk;hklist";break;default:d="netdisk;P2SP;3.0.10.22";break}e.value.user_agent=d};return(d,l)=>{const u=S,n=$,s=N,_=R,r=I,F=D,k=L,P=T,G=W;return Y((g(),w(P,{ref_key:"changeConfigFormRef",ref:V,model:t(e),rules:A,"label-width":"auto"},{default:i(()=>[m.Mode==="main"?(g(),y(U,{key:0},[a(n,{label:"前端版本号",prop:"front_end_version"},{default:i(()=>[a(u,{disabled:"",modelValue:t(e).front_end_version,"onUpdate:modelValue":l[0]||(l[0]=o=>t(e).front_end_version=o)},null,8,["modelValue"])]),_:1}),a(n,{label:"后端版本号",prop:"version"},{default:i(()=>[a(u,{disabled:"",modelValue:t(e).version,"onUpdate:modelValue":l[1]||(l[1]=o=>t(e).version=o)},null,8,["modelValue"])]),_:1}),a(n,{label:"站点名称",prop:"name"},{default:i(()=>[a(u,{modelValue:t(e).name,"onUpdate:modelValue":l[2]||(l[2]=o=>t(e).name=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),a(n,{label:"公告内容",prop:"announce"},{default:i(()=>[a(u,{type:"textarea",modelValue:t(e).announce,"onUpdate:modelValue":l[3]||(l[3]=o=>t(e).announce=o)},null,8,["modelValue"])]),_:1}),a(n,{label:"DEBUG模式开关",prop:"debug"},{default:i(()=>[a(s,{modelValue:t(e).debug,"onUpdate:modelValue":l[4]||(l[4]=o=>t(e).debug=o),size:"large"},null,8,["modelValue"])]),_:1}),a(n,{label:"邀请码开关",prop:"need_inv_code"},{default:i(()=>[a(s,{modelValue:t(e).need_inv_code,"onUpdate:modelValue":l[5]||(l[5]=o=>t(e).need_inv_code=o),size:"large"},null,8,["modelValue"])]),_:1}),a(n,{label:"白名单模式开关",prop:"whitelist_mode"},{default:i(()=>[a(s,{modelValue:t(e).whitelist_mode,"onUpdate:modelValue":l[6]||(l[6]=o=>t(e).whitelist_mode=o),size:"large"},null,8,["modelValue"])]),_:1}),a(n,{label:"展示版权信息",prop:"show_copyright"},{default:i(()=>[a(s,{modelValue:t(e).show_copyright,"onUpdate:modelValue":l[7]||(l[7]=o=>t(e).show_copyright=o),size:"large"},null,8,["modelValue"])]),_:1}),a(n,{label:"自定义版权",prop:"custom_copyright"},{default:i(()=>[a(u,{modelValue:t(e).custom_copyright,"onUpdate:modelValue":l[8]||(l[8]=o=>t(e).custom_copyright=o)},null,8,["modelValue"])]),_:1}),a(n,{label:"卡密模式开关",prop:"token_mode"},{default:i(()=>[a(s,{modelValue:t(e).token_mode,"onUpdate:modelValue":l[9]||(l[9]=o=>t(e).token_mode=o),size:"large"},null,8,["modelValue"])]),_:1}),a(n,{label:"卡网跳转链接",prop:"button_link"},{default:i(()=>[a(u,{modelValue:t(e).button_link,"onUpdate:modelValue":l[10]||(l[10]=o=>t(e).button_link=o)},null,8,["modelValue"])]),_:1}),a(n,{label:"显示登陆按钮",prop:"show_login_button"},{default:i(()=>[a(s,{modelValue:t(e).show_login_button,"onUpdate:modelValue":l[11]||(l[11]=o=>t(e).show_login_button=o),size:"large"},null,8,["modelValue"])]),_:1})],64)):v("",!0),m.Mode==="parse"?(g(),y(U,{key:1},[a(n,{label:"下载使用的 User_Agent",prop:"user_agent"},{default:i(()=>[a(u,{modelValue:t(e).user_agent,"onUpdate:modelValue":l[12]||(l[12]=o=>t(e).user_agent=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),a(n,{label:"批量解析时休眠时间（秒）",prop:"sleep"},{default:i(()=>[a(_,{modelValue:t(e).sleep,"onUpdate:modelValue":l[13]||(l[13]=o=>t(e).sleep=o)},null,8,["modelValue"])]),_:1}),a(n,{label:"批量解析时单次最大解析数量（个）",prop:"max_once"},{default:i(()=>[a(_,{modelValue:t(e).max_once,"onUpdate:modelValue":l[14]||(l[14]=o=>t(e).max_once=o)},null,8,["modelValue"])]),_:1}),a(n,{label:"单日单个账号最大解析大小（GB）",prop:"max_filesize"},{default:i(()=>[a(_,{modelValue:t(e).max_filesize,"onUpdate:modelValue":l[15]||(l[15]=o=>t(e).max_filesize=o),style:{width:"300px"}},null,8,["modelValue"])]),_:1}),a(n,{label:"可解析文件最小需要大小（GB）",prop:"min_single_filesize"},{default:i(()=>[a(_,{modelValue:t(e).min_single_filesize,"onUpdate:modelValue":l[16]||(l[16]=o=>t(e).min_single_filesize=o),style:{width:"300px"}},null,8,["modelValue"])]),_:1}),a(n,{label:"可解析文件最大可是大小（GB）",prop:"max_single_filesize"},{default:i(()=>[a(_,{modelValue:t(e).max_single_filesize,"onUpdate:modelValue":l[17]||(l[17]=o=>t(e).max_single_filesize=o),style:{width:"300px"}},null,8,["modelValue"])]),_:1}),a(n,{label:"解析密码",prop:"password"},{default:i(()=>[a(u,{modelValue:t(e).password,"onUpdate:modelValue":l[18]||(l[18]=o=>t(e).password=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),a(n,{label:"购买授权联系TG:"},{default:i(()=>[a(u,{disabled:"",value:"t.me/huan_kong"})]),_:1}),a(n,{label:"授权服务器",prop:"main_server"},{default:i(()=>[a(u,{modelValue:t(e).main_server,"onUpdate:modelValue":l[19]||(l[19]=o=>t(e).main_server=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),a(n,{label:"授权码",prop:"code"},{default:i(()=>[a(u,{modelValue:t(e).code,"onUpdate:modelValue":l[20]||(l[20]=o=>t(e).code=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),a(n,{label:"代理下载服务器",prop:"proxy_server"},{default:i(()=>[a(u,{modelValue:t(e).proxy_server,"onUpdate:modelValue":l[21]||(l[21]=o=>t(e).proxy_server=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),a(n,{label:"代理下载服务器密码",prop:"proxy_password"},{default:i(()=>[a(u,{modelValue:t(e).proxy_password,"onUpdate:modelValue":l[22]||(l[22]=o=>t(e).proxy_password=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),a(n,{label:"解析模式",prop:"parse_mode"},{default:i(()=>[a(F,{modelValue:t(e).parse_mode,"onUpdate:modelValue":l[23]||(l[23]=o=>t(e).parse_mode=o),onBlur:z,onChange:z},{default:i(()=>[a(r,{value:5,label:"V5盘内(开放平台接口)"}),a(r,{value:10,label:"V10盘内(开放平台接口)"}),a(r,{value:1,label:"V1盘内(原版V1,qdall下载可能失败,Windows)"}),a(r,{value:6,label:"V6盘内(改版V1,一定程度防风控)"}),a(r,{value:8,label:"V8盘内(改版V1,qdall下载可能失败,Android)"}),a(r,{value:2,label:"V2盘外(原版V2,qdall下载可能失败,Android)"}),a(r,{value:7,label:"V7盘外(改版V2,一定程度防风控)"}),a(r,{value:9,label:"V9盘外(改版V2,qdall下载可能失败,Windows)"}),a(r,{value:11,label:"V11盘内"}),a(r,{value:12,label:"V12盘外"})]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"省份模式开关",prop:"limit_prov"},{default:i(()=>[a(s,{modelValue:t(e).limit_prov,"onUpdate:modelValue":l[24]||(l[24]=o=>t(e).limit_prov=o),size:"large"},null,8,["modelValue"])]),_:1}),a(n,{label:"仅限中国用户使用",prop:"limit_cn"},{default:i(()=>[a(s,{modelValue:t(e).limit_cn,"onUpdate:modelValue":l[25]||(l[25]=o=>t(e).limit_cn=o),size:"large"},null,8,["modelValue"])]),_:1}),a(n,{label:"卡密绑定ip",prop:"token_bind_ip"},{default:i(()=>[a(s,{modelValue:t(e).token_bind_ip,"onUpdate:modelValue":l[26]||(l[26]=o=>t(e).token_bind_ip=o),size:"large"},null,8,["modelValue"])]),_:1})],64)):v("",!0),a(n,{label:" "},{default:i(()=>[a(k,{type:"primary",onClick:l[27]||(l[27]=o=>B(V.value))},{default:i(()=>[C("保存")]),_:1}),m.Mode==="parse"?(g(),w(k,{key:0,type:"primary",onClick:l[28]||(l[28]=o=>E(V.value))},{default:i(()=>[C(" 测试授权 ")]),_:1})):v("",!0)]),_:1})]),_:1},8,["model"])),[[G,p.value]])}}});export{ze as default};
