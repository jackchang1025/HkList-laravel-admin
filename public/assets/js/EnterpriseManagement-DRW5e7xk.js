/* empty css             *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css                  *//* empty css                  *//* empty css                        *//* empty css                     *//* empty css                  */import{k as T,a as u,b as Y,l as U,J as B,K as t,S as e,Q as p,L,d as Z,m as ee,p as M,aa as le,R as $,F as te}from"./vue-vendor-BPxk_gY3.js";import{u as ae,c as oe,g as ne,d as se,a as re,t as ie}from"./enterprise-DJ140WNJ.js";/* empty css                   *//* empty css                  */import{E as f,b as K,c as N,q as ue,e as P,d as j,k as de,v as G,s as R,i as pe,j as me,m as ce,t as ve,o as fe,u as _e}from"./element-plus-vendor-C_pH9kLN.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-PNpWQo2V.js";import"./other-vendor-DRuaNSIU.js";const be=T({__name:"AddEnterprise",props:{modelValue:{type:Boolean}},emits:["update:modelValue","getEnterprises"],setup(F,{expose:m,emit:V}){const E=F,y=V,k=u(),_=u(!1),d=u(null),o=u({cid:"",cookie:"",bdstoken:"",surl:"",pwd:"",path:"",is_active:!0}),h={cid:[{required:!0,message:"请输入企业CID",trigger:"blur"}],cookie:[{required:!0,message:"请输入Cookie",trigger:"blur"}],bdstoken:[{required:!0,message:"请输入安全令牌",trigger:"blur"}],surl:[{required:!0,message:"请输入分享链接",trigger:"blur"}],path:[{required:!0,message:"请输入存储路径",trigger:"blur"}]};Y(()=>E.modelValue,i=>{i||C()});const c=i=>{d.value=i,o.value={cid:i.cid,cookie:i.cookie,bdstoken:i.bdstoken,surl:i.surl,pwd:i.pwd||"",path:i.path,is_active:i.is_active}},C=()=>{k.value&&k.value.resetFields(),d.value=null,o.value={cid:"",cookie:"",bdstoken:"",surl:"",pwd:"",path:"",is_active:!0}},S=()=>{y("update:modelValue",!1),C()},z=async i=>{if(i)try{await i.validate(),_.value=!0,d.value?(await ae(d.value.id,o.value),f.success("更新成功")):(await oe(o.value),f.success("添加成功")),y("getEnterprises"),y("update:modelValue",!1)}catch(a){a!=="cancel"&&f.error(d.value?"更新失败":"添加失败")}finally{_.value=!1}};return m({setEditingEnterprise:c}),(i,a)=>{const g=K,v=N,D=ue,x=P,r=j,l=de,I=G;return U(),B(l,{title:d.value?"编辑企业账号":"添加企业账号",width:"60%","model-value":i.modelValue,"onUpdate:modelValue":a[8]||(a[8]=s=>y("update:modelValue",s)),"before-close":S},{footer:t(()=>[e(r,{onClick:S},{default:t(()=>a[10]||(a[10]=[p("取消")])),_:1}),e(r,{type:"primary",onClick:a[7]||(a[7]=s=>z(k.value))},{default:t(()=>a[11]||(a[11]=[p("确定")])),_:1})]),default:t(()=>[L((U(),B(x,{ref_key:"formRef",ref:k,model:o.value,rules:h,"label-width":"120px"},{default:t(()=>[e(v,{label:"企业CID",prop:"cid"},{default:t(()=>[e(g,{modelValue:o.value.cid,"onUpdate:modelValue":a[0]||(a[0]=s=>o.value.cid=s),placeholder:"请输入企业CID"},null,8,["modelValue"])]),_:1}),e(v,{label:"Cookie",prop:"cookie"},{default:t(()=>[e(g,{modelValue:o.value.cookie,"onUpdate:modelValue":a[1]||(a[1]=s=>o.value.cookie=s),type:"textarea",rows:3,placeholder:"请输入Cookie"},null,8,["modelValue"])]),_:1}),e(v,{label:"安全令牌",prop:"bdstoken"},{default:t(()=>[e(g,{modelValue:o.value.bdstoken,"onUpdate:modelValue":a[2]||(a[2]=s=>o.value.bdstoken=s),placeholder:"请输入bdstoken"},null,8,["modelValue"])]),_:1}),e(v,{label:"分享链接",prop:"surl"},{default:t(()=>[e(g,{modelValue:o.value.surl,"onUpdate:modelValue":a[3]||(a[3]=s=>o.value.surl=s),placeholder:"请输入分享链接"},null,8,["modelValue"])]),_:1}),e(v,{label:"提取密码",prop:"pwd"},{default:t(()=>[e(g,{modelValue:o.value.pwd,"onUpdate:modelValue":a[4]||(a[4]=s=>o.value.pwd=s),placeholder:"请输入提取密码(可选)"},null,8,["modelValue"])]),_:1}),e(v,{label:"存储路径",prop:"path"},{default:t(()=>[e(g,{modelValue:o.value.path,"onUpdate:modelValue":a[5]||(a[5]=s=>o.value.path=s),placeholder:"请输入存储路径"},{prepend:t(()=>a[9]||(a[9]=[p("/")])),_:1},8,["modelValue"])]),_:1}),e(v,{label:"状态",prop:"is_active"},{default:t(()=>[e(D,{modelValue:o.value.is_active,"onUpdate:modelValue":a[6]||(a[6]=s=>o.value.is_active=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[I,_.value]])]),_:1},8,["title","model-value"])}}}),ye={class:"toolbar"},ke={class:"action-buttons"},we=T({__name:"EnterpriseManagement",setup(F){const m=u(!1),V=u(1),E=u(15),y=u(0),k=u([]),_=u([]),d=u(!1),o=u({keyword:"",is_active:void 0}),h=u(null),c=async()=>{try{m.value=!0;const r=await ne({page:V.value,size:E.value,...o.value});k.value=r.data.list,y.value=r.data.pagination.total}finally{m.value=!1}},C=()=>{V.value=1,c()},S=()=>c(),z=()=>c(),i=r=>{_.value=r},a=()=>{d.value=!d.value},g=async r=>{try{await R.confirm("确定要删除该企业账号吗？","提示",{type:"warning"}),m.value=!0,await se(r.id),f.success("删除成功"),c()}catch(l){l!=="cancel"&&f.error("删除失败")}finally{m.value=!1}},v=async()=>{try{await R.confirm(`确定要删除选中的 ${_.value.length} 个企业账号吗？`,"提示",{type:"warning"}),m.value=!0,await re(_.value.map(r=>r.id)),f.success("批量删除成功"),c()}catch(r){r!=="cancel"&&f.error("批量删除失败")}finally{m.value=!1}},D=async r=>{try{m.value=!0;const l=await ie(r.id);f.success(l.data.status),c()}catch{f.error("操作失败")}finally{m.value=!1}},x=r=>{var l;(l=h.value)==null||l.setEditingEnterprise(r),d.value=!0};return Z(c),(r,l)=>{const I=K,s=N,q=pe,J=me,w=j,O=P,b=ce,Q=ve,H=fe,W=_e,X=G;return U(),ee(te,null,[e(be,{onGetEnterprises:c,modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=n=>d.value=n),ref_key:"addEnterpriseRef",ref:h},null,8,["modelValue"]),M("div",ye,[e(O,{inline:!0,model:o.value},{default:t(()=>[e(s,{label:"关键词"},{default:t(()=>[e(I,{modelValue:o.value.keyword,"onUpdate:modelValue":l[1]||(l[1]=n=>o.value.keyword=n),placeholder:"搜索CID/短链/路径",clearable:"",onKeyup:le(C,["enter"])},null,8,["modelValue"])]),_:1}),e(s,{label:"状态"},{default:t(()=>[e(J,{modelValue:o.value.is_active,"onUpdate:modelValue":l[2]||(l[2]=n=>o.value.is_active=n),clearable:"",placeholder:"全部"},{default:t(()=>[e(q,{label:"激活",value:!0}),e(q,{label:"停用",value:!1})]),_:1},8,["modelValue"])]),_:1}),e(s,null,{default:t(()=>[e(w,{type:"primary",onClick:C},{default:t(()=>l[7]||(l[7]=[p("搜索")])),_:1})]),_:1})]),_:1},8,["model"]),M("div",ke,[e(w,{type:"primary",onClick:l[3]||(l[3]=n=>c())},{default:t(()=>l[8]||(l[8]=[p("刷新列表")])),_:1}),e(w,{type:"primary",onClick:l[4]||(l[4]=n=>a())},{default:t(()=>l[9]||(l[9]=[p("添加账号")])),_:1}),e(w,{type:"danger",disabled:_.value.length<=0,onClick:v},{default:t(()=>l[10]||(l[10]=[p(" 批量删除 ")])),_:1},8,["disabled"])])]),L((U(),B(H,{data:k.value,border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:i},{default:t(()=>[e(b,{type:"selection",width:"40"}),e(b,{prop:"id",label:"ID",width:"80"}),e(b,{prop:"cid",label:"企业CID","min-width":"120"}),e(b,{prop:"surl",label:"分享链接","min-width":"120","show-overflow-tooltip":""}),e(b,{prop:"path",label:"存储路径","min-width":"120","show-overflow-tooltip":""}),e(b,{prop:"is_active",label:"状态",width:"100"},{default:t(({row:n})=>[e(Q,{type:n.is_active?"success":"danger"},{default:t(()=>[p($(n.is_active?"已激活":"已停用"),1)]),_:2},1032,["type"])]),_:1}),e(b,{prop:"created_at",label:"创建时间",width:"180"},{default:t(({row:n})=>[p($(new Date(n.created_at).toLocaleString()),1)]),_:1}),e(b,{width:"250",label:"操作",fixed:"right"},{default:t(({row:n})=>[e(w,{size:"small",type:n.is_active?"warning":"success",onClick:A=>D(n)},{default:t(()=>[p($(n.is_active?"停用":"激活"),1)]),_:2},1032,["type","onClick"]),e(w,{size:"small",type:"primary",onClick:A=>x(n)},{default:t(()=>l[11]||(l[11]=[p(" 编辑 ")])),_:2},1032,["onClick"]),e(w,{size:"small",type:"danger",onClick:A=>g(n)},{default:t(()=>l[12]||(l[12]=[p(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[X,m.value]]),e(W,{"current-page":V.value,"onUpdate:currentPage":l[5]||(l[5]=n=>V.value=n),"page-size":E.value,"onUpdate:pageSize":l[6]||(l[6]=n=>E.value=n),"page-sizes":[15,50,100],total:y.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:S,onCurrentChange:z},null,8,["current-page","page-size","total"])],64)}}}),Te=ge(we,[["__scopeId","data-v-503b4b6c"]]);export{Te as default};
