/* empty css             *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css                  *//* empty css                  *//* empty css                        */import"./AdminView-B3WA7Z1j.js";/* empty css                  */import{i as v}from"./index-PNpWQo2V.js";import{f as x}from"./format-CyW-QbYa.js";import{u as A}from"./changeConfigForm-CU20jSny.js";import{c as h}from"./copy-DePUZc8M.js";import{E as w,d as J,g as O,i as H,j as K,m as Q,o as q,u as G,v as W}from"./element-plus-vendor-C_pH9kLN.js";import{k as X,a as m,d as Y,l as B,m as Z,S as t,K as l,Q as r,R as d,u as k,L as ee,J as te,p as ae,F as oe}from"./vue-vendor-BPxk_gY3.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                */import"./other-vendor-DRuaNSIU.js";const ne=u=>v.get(`/admin/record?page=${u.page}&size=${u.size}&orderBy=${u.orderBy}`),re=()=>v.get("/admin/record/count"),se=u=>v.delete("/admin/record",{data:{record_ids:[u.id]}}),ie=u=>v.delete("/admin/record",{data:{record_ids:u}}),de=X({__name:"RecordManagement",setup(u){const s=m(!1),y=m(15),b=m(1),C=m("id"),_=m(),z=m([]),f=m({today:{count:0,size:0},total:{count:0,size:0}}),p=async()=>{try{s.value=!0;const o=await ne({page:b.value,size:y.value,orderBy:C.value});_.value=o.data}finally{s.value=!1,await D()}},D=async()=>{try{s.value=!0;const o=await re();f.value=o.data}finally{s.value=!1}},$=async o=>{try{s.value=!0,await se(o),w.success("删除记录成功")}finally{s.value=!1,await p()}},I=async()=>{try{s.value=!0;const o=z.value.map(e=>e.id);await ie(o),w.success("删除记录成功")}finally{s.value=!1,await p()}},L=o=>z.value=o;Y(p);function F(o){return o.map(e=>e.toString(16).padStart(2,"0")).join("")}function V(o,e){const i=e.length,g=[];for(let c=0;c<o.length;c++)g.push(o.charCodeAt(c)^e.charCodeAt(c%i));return F(g)}const P=o=>{const e=A(),i=e.changeConfigForm.proxy_server;if(!i)return w.warning("未配置代理服务器");h(i+"?data="+V(JSON.stringify({url:o.url,ua:o.ua}),e.changeConfigForm.proxy_password))};return(o,e)=>{var R,S,E;const i=J,g=O,c=H,T=K,n=Q,M=q,N=G,U=W;return B(),Z(oe,null,[t(i,{type:"primary",onClick:e[0]||(e[0]=a=>p())},{default:l(()=>e[5]||(e[5]=[r("刷新列表")])),_:1}),t(i,{type:"danger",disabled:z.value.length<=0,onClick:e[1]||(e[1]=a=>I())},{default:l(()=>e[6]||(e[6]=[r(" 批量删除 ")])),_:1},8,["disabled"]),t(g,{style:{"margin-left":"20px"}},{default:l(()=>[r(" 累计解析: "+d(f.value.total.count)+" ("+d(k(x)(f.value.total.size??0))+") ",1)]),_:1}),t(g,null,{default:l(()=>[r(" 今日解析: "+d(f.value.today.count)+" ("+d(k(x)(f.value.today.size??0))+") ",1)]),_:1}),t(g,{style:{"margin-left":"20px"}},{default:l(()=>[e[7]||(e[7]=r(" 按照 ")),t(T,{modelValue:C.value,"onUpdate:modelValue":e[2]||(e[2]=a=>C.value=a),onChange:p,style:{width:"100px"}},{default:l(()=>[t(c,{key:"id",label:"时间",value:"id"}),t(c,{key:"size",label:"文件大小",value:"size"})]),_:1},8,["modelValue"]),e[8]||(e[8]=r(" 排序 "))]),_:1}),ee((B(),te(M,{data:((R=_.value)==null?void 0:R.data)??[],border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:L},{default:l(()=>[t(n,{type:"selection",width:"40"}),t(n,{prop:"id",label:"ID"}),t(n,{prop:"ip",label:"IP"}),t(n,{prop:"fs_id",label:"文件ID"}),t(n,{prop:"file.filename",label:"文件名"}),t(n,{prop:"fs_id",label:"文件大小"},{default:l(({row:a})=>[ae("span",null,d(k(x)(a.file.size)),1)]),_:1}),t(n,{prop:"url",label:"下载链接"}),t(n,{prop:"ua",label:"UA"}),t(n,{prop:"user_id",label:"用户ID"},{default:l(({row:a})=>[r(d(a.user_id??"非用戶解析"),1)]),_:1}),t(n,{prop:"token_id",label:"卡密ID"},{default:l(({row:a})=>[r(d(a.token_id??"非卡密解析"),1)]),_:1}),t(n,{prop:"account_id",label:"解析账号ID"}),t(n,{prop:"created_at",label:"创建时间"},{default:l(({row:a})=>[r(d(new Date(a.created_at).toLocaleString()),1)]),_:1}),t(n,{prop:"updated_at",label:"更新时间"},{default:l(({row:a})=>[r(d(new Date(a.updated_at).toLocaleString()),1)]),_:1}),t(n,{width:"220",label:"操作",fixed:"right"},{default:l(({row:a})=>[t(i,{size:"small",type:"primary",onClick:j=>P(a)},{default:l(()=>e[9]||(e[9]=[r(" 获取代理服务器链接 ")])),_:2},1032,["onClick"]),t(i,{size:"small",type:"danger",onClick:j=>$(a)},{default:l(()=>e[10]||(e[10]=[r("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[U,s.value]]),t(N,{"current-page":b.value,"onUpdate:currentPage":e[3]||(e[3]=a=>b.value=a),"page-size":y.value,"onUpdate:pageSize":e[4]||(e[4]=a=>y.value=a),"page-sizes":[15,50,100,500,((S=_.value)==null?void 0:S.total)??100],total:((E=_.value)==null?void 0:E.total)??100,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:p,onCurrentChange:p},null,8,["current-page","page-size","page-sizes","total"])],64)}}}),Be=le(de,[["__scopeId","data-v-f57bd9b1"]]);export{Be as default};
